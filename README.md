# Use HTTP (å·²å®Œæˆ)

# ğŸª¶ ç‰¹å¾

- [x]  è™šæ‹Ÿå®šä½
- [x]  å®šæ—¶æ‰“å¡
- [x]  ä¸Šä¼ å‘¨æŠ¥
- [x]  å¤šç”¨æˆ·å®ç°
- [x]  è·å–å½“å¤©æ‰“å¡æƒ…å†µ

# ğŸ“œ ä½¿ç”¨æŒ‡å—

## ğŸ›– é¡¹ç›®ç»“æ„

```
â”œâ”€main.py ä¸»å‡½æ•°
â”œâ”€README.md
â”œâ”€report.txt å‘¨æŠ¥æ•°æ®
â”œâ”€zf_internship.sql æ•°æ®åº“æ–‡ä»¶
â”œâ”€log æ—¥å¿—æ–‡ä»¶
|  â””2023-9-5.log
â”œâ”€function åŠŸèƒ½å‡½æ•°
|    â”œâ”€data.py
|    â”œâ”€glo.py
|    â”œâ”€log.py
|    â”œâ”€sendEmail.py
|    â”œâ”€sql.py
|    â”œâ”€state.py
|    â”œâ”€__init__.py
â”œâ”€file READMEç…§ç‰‡
```

# ğŸ‘‰éœ€è¦åšçš„

1. æ‰§è¡Œ`sql.py`æ–‡ä»¶
   - æ’å…¥ç”¨æˆ·ä¿¡æ¯(åŒ…å«å­¦å·ã€ç™»å½•å¯†ç ã€é‚®ç®±)ã€æ‰“å¡åœ°å€ä¿¡æ¯ 

	2. æ›´æ”¹`data.py`æ–‡ä»¶

```python
loginURL = ""  # ç™»å½•åœ°å€
signURL = ""  # æ‰“å¡åœ°å€
singPageUrl = ""  # æ‰“å¡é¡µé¢åœ°å€
singInfoUrl = ""  # æ‰“å¡ä¿¡æ¯åœ°å€
reportURL = ""  # å‘¨æŠ¥ä¸Šä¼ åœ°å€
```

3. æ’å…¥å‘¨æŠ¥ `data.py`çš„`reportExecute()`å‡½æ•° ->  éå¿…è¦

## æœåŠ¡å™¨å®šæ—¶æ‰§è¡Œ

è‹¥éœ€è¦å®šæ—¶æ‰“å¡è€Œä¸æ˜¯æ¯æ¬¡æ‰“å¡éƒ½æ˜¯è‡ªå·±æ‰§è¡Œï¼Œéœ€æ‹¥æœ‰ä¸€å°æœåŠ¡å™¨( [é˜¿é‡Œäº‘é£å¤©è®¡åˆ’](https://developer.aliyun.com/plan/student) å¯å…è´¹è·å–ä¸ƒä¸ªæœˆæœåŠ¡å™¨ä½¿ç”¨ )  

<img src="file/image-20231116105443748.png" alt="image-20231116105443748|" style="zoom:25%;" />

ä¸‹é¢ç¨‹åºè¡¨æ˜ï¼Œæ¯å¤©8:21æ‰§è¡ŒæŒ‡å®šç¨‹åº

```shell
21 8 * * * /usr/bin/python3 /home/test/code/python/ZF-Internship/main.py
```

å†æŸ¥çœ‹cronè¿è¡ŒçŠ¶æ€ï¼Œæ˜¾ç¤ºäº†ä¸Šä¼ çš„æ•°æ®å†…å­˜ï¼ŒåŒæ—¶æŸ¥çœ‹logæ–‡ä»¶200 æ‰“å¡æˆåŠŸ  

![image-20231116105811868](file/image-20231116105811868.png)



æ— æ³•æ‰§è¡Œé”™è¯¯ï¼š 

```shell
service cron status
```

![image-20231116105608948](file/image-20231116105608948.png)

è¡¨æ˜ç³»ç»Ÿæœªå®‰è£…é‚®ç®±æœåŠ¡ï¼Œæ‰§è¡Œï¼š`sudo apt-get install postfix`

ä¸‹è½½å®Œæˆåï¼Œä¼šå¼¹å‡ºç´«è‰²ç•Œé¢ï¼Œé€‰æ‹©OKï¼Œç„¶åé€‰æ‹©æœ€åä¸€ä¸ªLocateï¼Œæœ¬åœ°ä½ç½®ï¼Œåé¢çš„ç›´æ¥OKå°±å¥½ä¸å¿…æ›´æ”¹ã€‚

```shell
vim /etc/pam.d/common-session-noninteractive
# å°†ä¸‹é¢å†…å®¹å¢åŠ åˆ°30è¡Œ
session [success=1 default=ignore] pam_succeed_if.so service in cron quiet use_uid  
```

![image-20231116105657437](file/image-20231116105657437.png)

é‡å¯crontabæœåŠ¡ï¼š`service cron restart`

[å‚è€ƒé“¾æ¥](https://askubuntu.com/questions/222512/cron-info-no-mta-installed-discarding-output-error-in-the-syslog)



---

**æ‰“å¡ç³»ç»Ÿæœ‰å¼€æ”¾æ—¶é—´ï¼ï¼ï¼ä¸€å®šè¦åœ¨å¼€æ”¾æ—¶é—´å†…å¯åŠ¨æˆ–å®Œæˆæ‰“å¡ï¼ˆæ—©ä¸Š7:00åˆ†å¼€å¯ï¼Œæ™šä¸Š22:00å…³é—­ï¼‰** 

ğŸ’ å¿ƒå¾—

æœ¬æ¬¡çš„ç¨‹åºç¼–å†™å¤šäº†è§£äº†äº›æœ‰å…³HTTPè¯·æ±‚çš„æ–¹å¼ä¸æ•°æ®äº¤äº’ï¼Œè‹¥åœ¨æ²¡æœ‰äººå®ç°è¯¥åŠŸèƒ½çš„æƒ…å†µä¸‹å¦‚ä½•ç¼–å†™ï¼Œå¦‚ä½•æŸ¥æ‰¾èµ„æ–™ä»¥åŠæœ€é‡è¦çš„å®ç°åŸç†ä¸é€»è¾‘ï¼  ä¹ŸèŠ±äº†è‡ªå·±å¾ˆå¤šæ—¶é—´ä¸ç²¾åŠ›ï¼Œå¤‡è€ƒå†…å®¹è½ä¸‹è®¸å¤šï¼Œä¼˜å…ˆçº§ä¼¼ä¹è¢«æˆ‘é—å¿˜äº†ï¼ˆç¼–ç¨‹å¤ªè®©æˆ‘å…¥è¿·ï¼‰

---

# ğŸ”— å‚è€ƒé“¾æ¥

[Requests: HTTP for Humansâ„¢ â€” Requests 2.31.0 documentation](https://requests.readthedocs.io/)

[æ‹¾å–åæ ‡ç³»ç»Ÿ](https://lbs.amap.com/)

[datetime â€” Basic date and time types](https://docs.python.org/3/library/datetime.html)