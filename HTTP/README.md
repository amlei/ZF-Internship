# Use HTTP (å·²å®Œæˆ)

# ğŸ“œ ä½¿ç”¨æŒ‡å—

## ğŸ›– é¡¹ç›®ç»“æ„

- log
    - æ—¥å¿—æ–‡ä»¶
- use
    - ä½¿ç”¨æƒ…å†µ (å¾…)
- data.py
    - æ•°æ®
- log.py
    - æ—¥å¿—
- main.py
    - ä¸»å‡½æ•°

![Untitled](./file/Untitled.png)

åªéœ€è¦ä¿®æ”¹data.pyæ–‡ä»¶å†…å®¹å³å¯ï¼š

- header  â€”â€”> å¤´æ–‡ä»¶
    - `User-Agent`
    - `Cookie`
    - `Accept`
- user  â€”â€”> ç”¨æˆ·ä¿¡æ¯
    - `ZFTAL_CSRF_TOKEN`
    - `yhm`
    - `mm`
    - `id`
- state  â€”â€”> åœ°ç†ä½ç½®
    - `longitude`
    - `latitude`
    - `location`

## ğŸ˜¶â€ğŸŒ«ï¸ Headerè·å–

- æ‰“å¼€æµè§ˆå™¨ï¼Œè¿›å»ç™»é™†ç½‘å€(å¤„äºéç™»é™†çŠ¶æ€)ã€æŒ‰ä¸‹F12æˆ–å³å‡»é¼ æ ‡ç‚¹å‡»æ£€æŸ¥
- ç‚¹å‡»ç½‘ç»œã€å…¨éƒ¨
- è¾“å…¥è´¦å·å¯†ç ç™»å½•ã€åœ¨ç½‘ç»œå¤„æ‰¾åˆ°slogin.zfçš„æ–‡ä»¶ã€æŸ¥çœ‹éœ€è¦çš„headeræ•°æ®å¹¶å¤åˆ¶åˆ°data.pyæ–‡ä»¶ä¸­



æ‰“å¼€æµè§ˆå™¨ï¼Œè¿›å»ç™»é™†ç½‘å€(å¤„äºéç™»é™†çŠ¶æ€)ã€æŒ‰ä¸‹F12æˆ–å³å‡»é¼ æ ‡ç‚¹å‡»æ£€æŸ¥

![Untitled](./file/Untitled%201.png)

ç‚¹å‡»ç½‘ç»œã€å…¨éƒ¨

![Untitled](./file/Untitled%202.png)

è¾“å…¥è´¦å·å¯†ç ç™»å½•ã€åœ¨ç½‘ç»œå¤„æ‰¾åˆ°slogin.zfçš„æ–‡ä»¶ã€æŸ¥çœ‹éœ€è¦çš„headeræ•°æ®å¹¶å¤åˆ¶åˆ°data.pyæ–‡ä»¶ä¸­

![123.png](./file/123.png)

## ğŸ‘¤ userç”¨æˆ·ä¿¡æ¯è·å–

ç”¨ä»¥ç™»é™†çš„ç”¨æˆ·åå’Œå¯†ç å¯¹åº”å¡«å†™å³å¯ï¼Œå¦‚ç”¨æˆ·åå’Œå¯†ç å‡ä¸º123456ï¼Œä¸å¿…å¡«å†™è¯¥ç½‘å€åŠ å¯†åçš„å¯†æ–‡ã€‚   

åŒæ ·åœ¨slong.zfå†…ï¼Œé‡Œé¢çš„**`ZFTAL_CSRF_TOKEN`** å¯¹åº”å¡«å†™

**iDçš„è·å–æœ‰ä¸¤ç§æ–¹å¼ã€‚**

ä¸è¦å…³é—­F12æ‰“å¼€çš„ç•Œé¢ / æ§åˆ¶å°è·å–idè¿˜éœ€è¦   â€”â€”â€”>  å»ºè®®æ˜¯æ‰“æ–­ç‚¹è·å–ï¼Œè¿™æ ·ä¸ä¼šç­¾åˆ°æˆåŠŸï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥ç‚¹å‡»ç­¾åˆ°è·å–idå€¼ï¼Œæ— å¦¨ã€‚

1. ä¸æ‰“æ–­ç‚¹ï¼ˆæœªæ‰“å¡çŠ¶æ€ï¼‰ è·å–id

ç‚¹å‡»ç­¾é€€ / ç­¾åˆ°ï¼Œç„¶åç›´æ¥å°±èƒ½çœ‹åˆ°inRange,zfå’Œsign.zfï¼Œä»»æ„ä¸€ä¸ªç‚¹å‡»è´Ÿè½½æŸ¥çœ‹å³å¯ã€‚

![123.png](./file/123%201.png)

1. æ‰“æ–­ç‚¹ï¼ˆå·²æ‰“å¡æ˜¾ç¤ºç­¾é€€çŠ¶æ€ï¼‰è·å–id
- é¼ æ ‡å³å‡»ç­¾é€€æŒ‰é’®ï¼Œè·å–ç­¾é€€çš„idï¼š`btn-sign-out`  ä½ ä¹Ÿå¯ä»¥ç›´æ¥å¤åˆ¶
- æŒ‰ä½é”®ç›˜Ctrl+shift+Fæ‰“å¡å…¨å±€æœç´¢
- æ‰“æ–­ç‚¹
- ç‚¹å‡»ç­¾é€€

![Untitled](./file/Untitled%203.png)

![Untitled](./file/Untitled%204.png)

![Untitled](./file/Untitled%205.png)

![123.png](./file/123%201.png)

## ğŸ‘ stateæ•°æ®è·å–

è§ä¸‹æ–¹æ³¨æ„äº‹é¡¹

---

ä¿®æ”¹å¥½åè¿è¡Œmain.pyæ–‡ä»¶å³å¯ã€‚

ä½ å¯ä»¥ä½¿ç”¨Pycharmã€Poweshell(æœ‰æ—¶ç§°ä½œå‘½ä»¤è¡Œ)ã€Linuxå‡å¯ã€‚

- Pycharmï¼š é…ç½®å¥½Pythonç¯å¢ƒç‚¹å‡»è¿è¡Œ / Ctrl + shift + F10å³å¯
- Poweshell: è¿›å…¥å½“é¡¹ç›®ç›®å½•ï¼Œæ‰§è¡Œï¼ˆLinuxåŒï¼‰:

```powershell
python3 main.py
```

åœ¨æ‰§è¡Œå‰ä½ è¿˜éœ€è¦é˜…è¯»ğŸš¨æ³¨æ„äº‹é¡¹

---

# ğŸš¨ æ³¨æ„äº‹é¡¹

data.pyæ–‡ä»¶çš„stateç±»ä¸€å®šè¦ç¡®è®¤å¥½å†è¿è¡Œç¨‹åºã€‚ 

```python
"""
åœ°ç‚¹ä¿¡æ¯
"""
class state():
    # æ•°æ®è·å–: https://api.map.baidu.com/lbsapi/getpoint/
    # å»ºè®®ç»çº¬åº¦ä¸ºå…­ä½å°æ•°ï¼Œèƒ½å¤ŸåŒ¹é…æ‰“å¡ä¿¡æ¯
    longitude = 0  # æ‰“å¡ç»åº¦
    latitude = 0  # æ‰“å¡ç»´åº¦
    location = ""  # æ‰“å¡åœ°ç‚¹

    # å¦‚æœä½ å·²å¡«æŠ¥å®ä¹ åœ°ç‚¹ï¼Œå¹¶ä¸”è·å–çš„ç»çº¬åº¦ä¸ºå®ä¹ åœ°ç‚¹é™„è¿‘ï¼Œéœ€å°† 'zkqfw'ç±»å‹æ›´æ”¹ä¸º1
    datas = {
        "mbjd": "{:.2f}".format(longitude - 0.75),
        "mbwd": "{:.2f}".format(latitude + 0.65),
        "yxwc": 500,
        "kqjd": longitude,
        "kqwd": latitude,
        "kqddxx": location,
        "rwxm_id": user.id,  # ç”¨æˆ·id: æ¯ä¸ªè´¦å·éƒ½æ˜¯å”¯ä¸€çš„ï¼Œéœ€æŠ“åŒ…è·å–
        "kqlx": 0,   # è€ƒå‹¤ç±»å‹: 0 -> ç­¾åˆ°,1 -> ç­¾é€€
        "zkqfw": 0,  # åœ¨è€ƒå‹¤èŒƒå›´: 0 -> å¦, 1 -> æ˜¯
    }
```

ä½ éœ€è¦æ³¨æ„å“ªäº›æ–¹é¢ï¼Ÿ

1. locationçš„åœ°ç‚¹ä¿¡æ¯
   
    è¯·å°†ä¸‹é¢æ ‡æ³¨å‡º`location`å†…çš„ä¸¤ä¸ªå‚æ•°æ›´æ”¹æ‰“å¡çš„ç»çº¬åº¦ ([ç‚¹å‡»è·å–ç»çº¬åº¦](https://api.map.baidu.com/lbsapi/getpoint/))ï¼Œç„¶åè¾“å…¥åˆ°æµè§ˆå™¨å†…æŸ¥çœ‹ï¼Œè·å–`â€˜formatted_addressâ€™` åé¢çš„åœ°å€ä¿¡æ¯åŒæ—¶å»é™¤æ‰çœã€å¸‚çº§ã€‚å¦‚ï¼šåŒ—äº¬å¸‚ä¸œåŸåŒºä¸œåé—¨è¡—é“äº”è‰²é—¨åŒ—äº¬å¸‚åŠ³åŠ¨äººæ°‘æ–‡åŒ–å®«ï¼Œåªå–ï¼šä¸œåé—¨è¡—é“äº”è‰²é—¨åŒ—äº¬å¸‚åŠ³åŠ¨äººæ°‘æ–‡åŒ–å®«ã€‚
    
    ![image-20230905153603189](file/image-20230905153603189.png)
    
    ```html
    https://restapi.amap.com/v3/geocode/regeo?key=81fc7500f0108a49ae6981032684771b&s=rsv3&language=zh_cn&location=116.40,39.91&jscode=3085e982657730ecef95e2ccaed9b93c&extensions=base&callback=jsonp_885644_&platform=JS&logversion=2.0&appname=https%3A%2F%2Fjw.gdcvi.edu.cn%2Fdgsx%2Fsxkq%2Fsxrckq%2FcxSxrckqWap.zf&csid=5408D4FC-728D-4261-A6B9-ACBBDBC89B23&sdkversion=1.4.22
    ```
    
    ![Untitled](./file/Untitled%206.png)
    
2. zkqfw æ˜¯å¦åœ¨è€ƒå‹¤èŒƒå›´
   
    å¦‚ä½•åˆ¤å®šè¯¥æ‰“å¡çš„åŒºåŸŸæ˜¯å¦åœ¨è€ƒå‹¤èŒƒå›´å‘¢ï¼Ÿä»¥ä¸‹ä¸‰ç§æƒ…å†µ
    
    - å¦‚æœä½ å¡«å†™äº†å®ä¹ åœ°ç‚¹ï¼Œä½†ä½ è¦æ‰“å¡çš„åœ°ç‚¹ä¸åœ¨å®ä¹ åœ°ç‚¹çš„èŒƒå›´åˆ™ä¸åœ¨è€ƒå‹¤èŒƒå›´ï¼ˆä¸å¿…æ›´æ”¹ï¼‰ï¼š0
    - å¦‚æœå¡«å†™äº†å®ä¹ åœ°ç‚¹ï¼Œä¸”æ‰“å¡çš„åœ°å€è·Ÿå®ä¹ åœ°ç‚¹ç›¸åŒåˆ™è¦æ›´æ”¹ä¸ºï¼š1
    - è‹¥æ²¡å¡«å†™å®ä¹ åœ°ç‚¹ï¼š0

ä¸ºé¿å…éæœ¬æ ¡ç”Ÿè·å–åˆ°æœ¬å…¬å¼€åçš„é¡¹ç›®è€Œå¯¹å®ä¹ ç½‘å€è¿›è¡Œæ”»å‡»ï¼Œæ‰€ä»¥é¡¹ç›®åœ°å€è¢«æˆ‘æ¸…ç©ºï¼Œè€Œæ”¾åœ¨è¿™é‡Œï¼Œè¯·è·å–åˆ°æœ¬é¡¹ç›®ååˆ†äº«åˆ°ç½‘ç»œä¸Šæ—¶è¯·ä¸€å¹¶åˆ é™¤ç½‘ç«™åœ°å€ï¼

---

# ğŸ”— å‚è€ƒé“¾æ¥

[Requests: HTTP for Humansâ„¢ â€” Requests 2.31.0 documentation](https://requests.readthedocs.io/)

[æ‹¾å–åæ ‡ç³»ç»Ÿ](https://api.map.baidu.com/lbsapi/getpoint/)

[åæ ‡ä¿¡æ¯](https://restapi.amap.com/v3/geocode/regeo?key=81fc7500f0108a49ae6981032684771b&s=rsv3&language=zh_cn&location=116.40,39.91&jscode=3085e982657730ecef95e2ccaed9b93c&extensions=base&callback=jsonp_885644_&platform=JS&logversion=2.0&appname=https%3A%2F%2Fjw.gdcvi.edu.cn%2Fdgsx%2Fsxkq%2Fsxrckq%2FcxSxrckqWap.zf&csid=5408D4FC-728D-4261-A6B9-ACBBDBC89B23&sdkversion=1.4.22)

[datetime â€” Basic date and time types](https://docs.python.org/3/library/datetime.html)